- max_vcpus:
    type = "max_vcpus"
    start_vm = "no"

    variants:
        - virsh_maxvcpus:
            no pseries, s390-virtio
            check = "virsh_maxvcpus"
            report_num = "255"
        - virsh_capabilities:
            check = "virsh_capabilities"
            report_num_pc_7 = "255"
            report_num_q35_73 = "255"
            report_num_q35_7_8 = "288"
        - positive_test:
            status_error = "no"
            variants:
                - i440fx_test:
                    only i440fx
                    guest_vcpu = "240"
                    vcpu_sockets = "2"
                    vcpu_cores = "120"
                    vcpu_threads = "1"
                    variants:
                        - default:
                            check = "i440fx_test_default"
                        - hotplug:
                            check = "i440fx_test_hotplug"
                            current_vcpu = "2"
                            target_vcpu = "50"
                - ioapic_iommu:
                    guest_vcpu = "50"
                    vcpu_sockets = "2"
                    vcpu_cores = "25"
                    vcpu_threads = "1"
                    only q35
                    variants:
                        - default:
                            check = "ioapic_iommu"
                            boot_timeout = "1000"
                        - hotplug:
                            check = "ioapic_iommu_hotplug"
        - negative_test:
            status_error = "yes"
            start_fail = "yes"
            variants:
                - i440fx_test:
                    only i440fx
                    check = "i440fx_test_negative"
                    guest_vcpu = "241"
                    vcpu_sockets = "1"
                    vcpu_cores = "241"
                    vcpu_threads = "1"
                    err_msg = "unsupported configuration: Maximum CPUs greater than specified machine type limit"
                - no_iommu:
                    only q35
                    check = "no_iommu"
                    guest_vcpu = "256"
                    vcpu_sockets = "2"
                    vcpu_cores = "128"
                    vcpu_threads = "1"
                    err_msg = "unsupported configuration: more than 255 vCPUs require extended interrupt mode enabled on the iommu device"
                - with_iommu:
                    only q35
                    check = "with_iommu"
                    guest_vcpu = "256"
                    vcpu_sockets = "2"
                    vcpu_cores = "128"
                    vcpu_threads = "1"
                    err_msg = "IOMMU interrupt remapping requires split I/O APIC \(ioapic driver='qemu'\)"
                - ioapic_iommu:
                    only q35
                    check = "ioapic_iommu_ne"
                    guest_vcpu = "289"
                    vcpu_sockets = "1"
                    vcpu_cores = "289"
                    vcpu_threads = "1"
                    err_msg = "unsupported configuration: Maximum CPUs greater than specified machine type limit"
